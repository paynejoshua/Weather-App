<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="stylesheet.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link href='https://css.gg/search.css' rel='stylesheet'>

    <title>Weather App</title>
</head>
<body>
    <section>
        <div class="w3-row">
        <h1 class="header w3-col">Current Weather</h1>
    </div>


    <div class="container">
        
        <div class="w3-row-padding">
            
        <form id="search-fields">
            <input class="w3-quarter w3-row-padding w3-mobile locationSearch" id="city-search" type="text" placeholder="City" value="Kirkland">
            <input class="w3-quarter w3-row-padding w3-mobile locationSearch" id="state-search" type="text" placeholder="State Code" value="WA">
            <input class="w3-quarter w3-row-padding w3-mobile locationSearch" id="country-search" type="text" placeholder="Country Code" value="US">
        </form> 
            <div>
            <i class="gg-search"></iclass></i>
            <button id="searchBtn">Search</button>
        </div>
            
                <div class="w3-half w3-cell-bottom forecast">
                    <p>5 day forecast</p>
                    
                </div>
                <div class="w3-quarter w3-row-padding w3-mobile current"  id="current-weather">Current Weather Conditions:</div>
           
            </div>
            
         </div>
        
        
</div>
    
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script type="text/JavaScript">


$("#searchBtn").on("click", function(event){
event.preventDefault();
let city = $("#city-search").val();

let state = $("#state-search").val();

let country = $("#country-search").val();

let searchKey = city + "," + state + "," + country

let APIKey = "a4a8fbe7c144be93020e3a7f15b622db"



let coordinates = []


// `&lat=${lat}&lon=${lon}`

console.log(coordinates)



let forecastURL = `https://api.openweathermap.org/data/2.5/forecast?q=${searchKey}&appid=${APIKey}`;

// create container div 

$.ajax({
      url: forecastURL,
      method: "GET"
      
    })
      .then(function(response1) {

        // console.log(forecastURL);

        console.log(response1);

        coordinates.push(response1.city.coord)
        
        // this will give me an average out of the next 5 days. I chose 11am. 
        for (let i = 5; i < response1.list.length; i+=8) {
           let hourlyForecast =  response1.list[i].weather[0];
            
            let localDate = new Date(response1.list[i].dt * 1000).toLocaleDateString();


            // console.log(response1.list[i]);
            let forecastDate = $("<label>");
                forecastDate.text(localDate)
            let forecastImg = $("<img>")
                 let weatherIcon = `http://openweathermap.org/img/wn/${hourlyForecast.icon}@2x.png`;
                forecastImg.attr("src", weatherIcon);

            
            let forecastTemp = $("<label>");
                forecastTemp.text(((response1.list[i].main.temp-273.15) * 1.80 + 32).toFixed(0) + " F ");
            let forecastHumid = $("<label>");
                forecastHumid.text(" Humidity: " + response1.list[i].main.humidity)
            let forecast = $("<div class='forecastContainer'></div>")

            forecast.append(forecastDate).append(forecastImg).append(forecastTemp).append(forecastHumid)


            $(".forecast").append(forecast)
            

        } 
          
      })

    let currentWeatherURL = `https://api.openweathermap.org/data/2.5/weather?q=${searchKey}&appid=${APIKey}`;

      $.ajax({
          url: currentWeatherURL,
          method: "GET"
      })
        .then(function(response2) {
            
            // console.log(currentWeatherURL);

            // console.log(response2);


        })

    // let uvURL = `http://api.openweathermap.org/data/2.5/uvi?appid=${APIKey}&lat=${coordinates}`

    //  $.ajax({
    //      url: uvURL,
    //      method: "GET"
    //  })
    //     .then(function(response3){
    //         console.log(uvURL)
    //         console.log(response3)

    //     })

      
      });



</script>

</body>

</html>

<!-- GIVEN a weather dashboard with form inputs
Part I
// WHEN I search for a city
// THEN I am presented with current and future conditions for that city and that city is added to the search history
// WHEN I view current weather conditions for that city
// THEN I am presented with the city name, the date, an icon representation of weather conditions, the temperature, the humidity, the wind speed, and the UV index
// WHEN I view the UV index
// THEN I am presented with a color that indicates whether the conditions are favorable, moderate, or severe
// WHEN I view future weather conditions for that city
// THEN I am presented with a 5-day forecast that displays the date, an icon representation of weather conditions, the temperature, and the humidity

Part II
// WHEN I click on a city in the search history
// THEN I am again presented with current and future conditions for that city
// WHEN I open the weather dashboard
// THEN I am presented with the last searched city forecast -->